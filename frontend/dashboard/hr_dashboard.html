<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR</title>
</head>
<body>
{% extends 'dashboard/base.html' %}

{% block content %}
<h1>HR Dashboard</h1>

<p>Welcome HR {{ user.username }}</p>

<h2>Approve pending</h2>
<table border="1">
    <tr>
        <th>Username</th>
        <th>Email</th>
        <th>Approve</th>
    </tr>
    {% for profile in pending_users %}
    <tr>
        <td>{{ profile.user.username }}</td>
        <td>{{ profile.user.email }}</td>
        <td>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="approve_id" value="{{ profile.user.id }}">
                <button type="submit">Approve</button>
            </form>
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="3">No pending approvals</td>
    </tr>
    {% endfor %}
</table>

<h2>Manage User Accounts</h2>

<a href="{% url 'hr_create_user' %}">âž• Create New Account</a>

<table border="1">
    <tr>
        <th>Username</th>
        <th>Email</th>
        <th>Role</th>
        <th>Status</th>
        <th>Actions</th>
    </tr>

    {% for u in all_users %}
    <tr>
        <td>{{ u.username }}</td>
        <td>{{ u.email }}</td>
        <td>{{ u.userprofile.role }}</td>
        <td>
            {% if u.is_active %}Active{% else %}Deactivated{% endif %}
        </td>
        <td>
            <a href="{% url 'hr_update_user' u.id %}">Edit</a>

            <form method="post" action="{% url 'hr_toggle_user' u.id %}" style="display:inline;">
                {% csrf_token %}
                {% if u.is_active %}
                    <button type="submit">Deactivate</button>
                {% else %}
                    <button type="submit">Activate</button>
                {% endif %}
            </form>
        </td>
    </tr>
    {% endfor %}
</table>

<a href="{% url 'hr_dashboard' %}">Manage Trainings</a>

{% endblock %}
</body>
</html>
